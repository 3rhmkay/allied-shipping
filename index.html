<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Allied Shipping Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; padding: 20px; background:#f4f6f8; }
.card { background:#fff; padding:20px; margin-bottom:20px; border:1px solid #ccc; }
button { padding:10px; background:#0a1f44; color:#fff; border:none; }
input { padding:10px; width:100%; margin-top:10px; }
</style>
</head>

<body>

<div class="card">
  <h2>Generate Shipment</h2>
  <input id="origin" placeholder="Origin">
  <input id="destination" placeholder="Destination">
  <button onclick="generateShipment()">Generate</button>
  <div id="generated"></div>
</div>

<div class="card">
  <h2>Track Shipment</h2>
  <input id="trackInput" placeholder="Tracking Number">
  <button onclick="trackShipment()">Track</button>
  <div id="result"></div>
</div>

<script>
// FORCE CLEAN STORAGE (IMPORTANT)
localStorage.removeItem("shipments");

/* STORAGE */
function getShipments() {
  return JSON.parse(localStorage.getItem("shipments") || "{}");
}
function saveShipments(s) {
  localStorage.setItem("shipments", JSON.stringify(s));
}

/* TRACKING NUMBER */
function generateTracking() {
  return "ASC-" + Math.floor(100000 + Math.random() * 900000);
}

/* GENERATE */
function generateShipment() {
  const origin = document.getElementById("origin").value.trim();
  const destination = document.getElementById("destination").value.trim();
  if (!origin || !destination) return alert("Fill both fields");

  const shipments = getShipments();
  const tracking = generateTracking();

  shipments[tracking] = {
    origin,
    destination,
    status: "Created"
  };

  saveShipments(shipments);

  document.getElementById("generated").innerHTML =
    "<p><strong>Tracking:</strong> " + tracking + "</p>";
}

/* TRACK */
function trackShipment() {
  const id = document.getElementById("trackInput").value.trim();
  const shipments = getShipments();
  const s = shipments[id];

  document.getElementById("result").innerHTML = s
    ? `<p>Status: ${s.status}<br>From: ${s.origin}<br>To: ${s.destination}</p>`
    : "<p style='color:red'>Not found</p>";
}
</script>

</body>
</html>
